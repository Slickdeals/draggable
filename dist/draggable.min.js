!function(t,e){"object"==typeof exports?module.exports=e():"function"==typeof define&&define.amd?define([],e):t.Draggable=e()}(this,function(){"use strict";var t={grid:0,filterTarget:null,limit:{x:null,y:null},threshold:0,setCursor:!1,setPosition:!0,smoothDrag:!0,useGPU:!0,onDrag:a,onDragStart:a,onDragEnd:a},e={assign:function(){for(var t=arguments[0],e=arguments.length,n=1;n<e;n++){var o=arguments[n];for(var i in o)t[i]=o[i]}return t},bind:function(t,e){return function(){t.apply(e,arguments)}},on:function(t,n,o){if(n&&o)e.addEvent(t,n,o);else if(n)for(var i in n)e.addEvent(t,i,n[i])},off:function(t,n,o){if(n&&o)e.removeEvent(t,n,o);else if(n)for(var i in n)e.removeEvent(t,i,n[i])},limit:function(t,e){return e instanceof Array?t<(e=[+e[0],+e[1]])[0]?t=e[0]:t>e[1]&&(t=e[1]):t=+e,t},addEvent:"attachEvent"in Element.prototype?function(t,e,n){t.attachEvent("on"+e,n)}:function(t,e,n){t.addEventListener(e,n,!1)},removeEvent:"attachEvent"in Element.prototype?function(t,e,n){t.detachEvent("on"+e,n)}:function(t,e,n){t.removeEventListener(e,n)}};function n(n,o){var i=this,r=e.bind(i.start,i),a=e.bind(i.drag,i),u=e.bind(i.stop,i);if(!s(n))throw new TypeError("Draggable expects argument 0 to be an Element");o=e.assign({},t,o),e.assign(i,{element:n,handle:o.handle&&s(o.handle)?o.handle:n,handlers:{start:{mousedown:r,touchstart:r},move:{mousemove:a,mouseup:u,touchmove:a,touchend:u}},options:o}),i.initialize()}function o(t){return parseInt(t,10)}function i(t){return"currentStyle"in t?t.currentStyle:getComputedStyle(t)}function r(t){return null!=t}function s(t){return t instanceof Element||"undefined"!=typeof HTMLDocument&&t instanceof HTMLDocument}function a(){}return e.assign(n.prototype,{setOption:function(t,e){var n=this;return n.options[t]=e,n.initialize(),n},get:function(){var t=this.dragEvent;return{x:t.x,y:t.y}},set:function(t,e){var n=this,o=n.dragEvent;return o.original={x:o.x,y:o.y},n.move(t,e),n},dragEvent:{started:!1,x:0,y:0},initialize:function(){var t,n={transform:function(){for(var t=" -o- -ms- -moz- -webkit-".split(" "),e=document.body.style,n=t.length;n--;){var o=t[n]+"transform";if(o in e)return o}}()},o=this,r=o.element,s=(o.handle,r.style),a=i(r),u=o.options,f=n.transform,l=o._dimensions={height:r.offsetHeight,left:r.offsetLeft,top:r.offsetTop,width:r.offsetWidth};u.useGPU&&f&&("none"===(t=a[f])&&(t=""),s[f]=t+" translate3d(0,0,0)"),u.setPosition&&(s.display="block",s.left=l.left+"px",s.top=l.top+"px",s.width=l.width+"px",s.height=l.height+"px",s.bottom=s.right="auto",s.margin=0,s.position="absolute"),u.setCursor&&(s.cursor="move"),o.setLimit(u.limit),e.assign(o.dragEvent,{x:l.left,y:l.top}),e.on(o.handle,o.handlers.start)},start:function(t){var n=this,o=n.getCursor(t),i=n.element;n.useTarget(t.target||t.srcElement)&&(t.preventDefault&&!t.target.getAttribute("contenteditable")?t.preventDefault():t.target.getAttribute("contenteditable")||(t.returnValue=!1),n.dragEvent.oldZindex=i.style.zIndex,i.style.zIndex=2147483647,n.setCursor(o),n.setPosition(),n.setZoom(),e.on(document,n.handlers.move))},drag:function(t){var e=this,n=e.dragEvent,o=e.element,i=e._cursor,r=e._dimensions,s=e.options,a=r.zoom,u=e.getCursor(t),f=s.threshold,l=(u.x-i.x)/a+r.left,d=(u.y-i.y)/a+r.top;!n.started&&f&&Math.abs(i.x-u.x)<f&&Math.abs(i.y-u.y)<f||(n.original||(n.original={x:l,y:d}),n.started||(s.onDragStart(o,l,d,t),n.started=!0),e.move(l,d)&&s.onDrag(o,n.x,n.y,t))},move:function(t,e){var n=this,o=n.dragEvent,i=n.options,r=i.grid,s=n.element.style,a=n.limit(t,e,o.original.x,o.original.y);return!i.smoothDrag&&r&&(a=n.round(a,r)),(a.x!==o.x||a.y!==o.y)&&(o.x=a.x,o.y=a.y,s.left=a.x+"px",s.top=a.y+"px",!0)},stop:function(t){var n,o=this,i=o.dragEvent,r=o.element,s=o.options,a=s.grid;e.off(document,o.handlers.move),r.style.zIndex=i.oldZindex,s.smoothDrag&&a&&(n=o.round({x:i.x,y:i.y},a),o.move(n.x,n.y),e.assign(o.dragEvent,n)),o.dragEvent.started&&s.onDragEnd(r,i.x,i.y,t),o.reset()},reset:function(){this.dragEvent.started=!1},round:function(t){var e=this.options.grid;return{x:e*Math.round(t.x/e),y:e*Math.round(t.y/e)}},getCursor:function(t){return{x:(t.targetTouches?t.targetTouches[0]:t).clientX,y:(t.targetTouches?t.targetTouches[0]:t).clientY}},setCursor:function(t){this._cursor=t},setLimit:function(t){var n=this,o=function(t,e){return{x:t,y:e}};if(t instanceof Function)n.limit=t;else if(s(t)){var i=n._dimensions,a=t.scrollHeight-i.height,u=t.scrollWidth-i.width;n.limit=function(t,n){return{x:e.limit(t,[0,u]),y:e.limit(n,[0,a])}}}else if(t){var f=r(t.x),l=r(t.y);n.limit=f||l?function(n,o){return{x:f?e.limit(n,t.x):n,y:l?e.limit(o,t.y):o}}:o}else n.limit=o},setPosition:function(){var t=this.element,n=t.style;e.assign(this._dimensions,{left:o(n.left)||t.offsetLeft,top:o(n.top)||t.offsetTop})},setZoom:function(){for(var t=this.element,e=1;t=t.offsetParent;){var n=i(t).zoom;if(n&&"normal"!==n){e=n;break}}this._dimensions.zoom=e},useTarget:function(t){var e=this.options.filterTarget;return!(e instanceof Function)||e(t)},destroy:function(){e.off(this.handle,this.handlers.start),e.off(document,this.handlers.move)}}),n});