!function(t,e){"object"==typeof exports?module.exports=e():"function"==typeof define&&define.amd?define([],e):t.Draggable=e()}(this,function(){"use strict";var s={grid:0,filterTarget:null,limit:{x:null,y:null},threshold:0,setCursor:!1,setPosition:!0,smoothDrag:!0,useGPU:!0,onDrag:e,onDragStart:e,onDragEnd:e},u={transform:function(){for(var t=" -o- -ms- -moz- -webkit-".split(" "),e=document.body.style,n=t.length;n--;){var o=t[n]+"transform";if(o in e)return o}}()},f={assign:function(){for(var t=arguments[0],e=arguments.length,n=1;n<e;n++){var o=arguments[n];for(var i in o)t[i]=o[i]}return t},bind:function(t,e){return function(){t.apply(e,arguments)}},on:function(t,e,n){if(e&&n)f.addEvent(t,e,n);else if(e)for(var o in e)f.addEvent(t,o,e[o])},off:function(t,e,n){if(e&&n)f.removeEvent(t,e,n);else if(e)for(var o in e)f.removeEvent(t,o,e[o])},limit:function(t,e){return e instanceof Array?t<(e=[+e[0],+e[1]])[0]?t=e[0]:t>e[1]&&(t=e[1]):t=+e,t},addEvent:"attachEvent"in Element.prototype?function(t,e,n){t.attachEvent("on"+e,n)}:function(t,e,n){t.addEventListener(e,n,!1)},removeEvent:"attachEvent"in Element.prototype?function(t,e,n){t.detachEvent("on"+e,n)}:function(t,e,n){t.removeEventListener(e,n)}};function t(t,e){var n=this,o=f.bind(n.start,n),i=f.bind(n.drag,n),r=f.bind(n.stop,n);if(!h(t))throw new TypeError("Draggable expects argument 0 to be an Element");e=f.assign({},s,e),f.assign(n,{element:t,handle:e.handle&&h(e.handle)?e.handle:t,handlers:{start:{mousedown:o,touchstart:o},move:{mousemove:i,mouseup:r,touchmove:i,touchend:r}},options:e}),n.initialize()}function n(t){return parseInt(t,10)}function l(t){return"currentStyle"in t?t.currentStyle:getComputedStyle(t)}function d(t){return null!=t}function h(t){return t instanceof Element||"undefined"!=typeof HTMLDocument&&t instanceof HTMLDocument}function e(){}return f.assign(t.prototype,{setOption:function(t,e){return this.options[t]=e,this.initialize(),this},get:function(){var t=this.dragEvent;return{x:t.x,y:t.y}},set:function(t,e){var n=this.dragEvent;return n.original={x:n.x,y:n.y},this.move(t,e),this},dragEvent:{started:!1,x:0,y:0},initialize:function(){var t,e=this,n=e.element,o=(e.handle,n.style),i=l(n),r=e.options,s=u.transform,a=e._dimensions={height:n.offsetHeight,left:n.offsetLeft,top:n.offsetTop,width:n.offsetWidth};r.useGPU&&s&&("none"===(t=i[s])&&(t=""),o[s]=t+" translate3d(0,0,0)"),r.setPosition&&(o.display="block",o.left=a.left+"px",o.top=a.top+"px",o.width=a.width+"px",o.height=a.height+"px",o.bottom=o.right="auto",o.margin=0,o.position="absolute"),r.setCursor&&(o.cursor="move"),e.setLimit(r.limit),f.assign(e.dragEvent,{x:a.left,y:a.top}),f.on(e.handle,e.handlers.start)},start:function(t){var e=this,n=e.getCursor(t),o=e.element;e.useTarget(t.target||t.srcElement)&&(t.preventDefault&&!t.target.getAttribute("contenteditable")?t.preventDefault():t.target.getAttribute("contenteditable")||(t.returnValue=!1),e.dragEvent.oldZindex=o.style.zIndex,o.style.zIndex=2147483647,e.setCursor(n),e.setPosition(),e.setZoom(),f.on(document,e.handlers.move))},drag:function(t){var e=this,n=e.dragEvent,o=e.element,i=e._cursor,r=e._dimensions,s=e.options,a=r.zoom,u=e.getCursor(t),f=s.threshold,l=(u.x-i.x)/a+r.left,d=(u.y-i.y)/a+r.top;!n.started&&f&&Math.abs(i.x-u.x)<f&&Math.abs(i.y-u.y)<f||(n.original||(n.original={x:l,y:d}),n.started||(s.onDragStart(o,l,d,t),n.started=!0),e.move(l,d)&&s.onDrag(o,n.x,n.y,t))},move:function(t,e){var n=this,o=n.dragEvent,i=n.options,r=i.grid,s=n.element.style,a=n.limit(t,e,o.original.x,o.original.y);return!i.smoothDrag&&r&&(a=n.round(a,r)),(a.x!==o.x||a.y!==o.y)&&(o.x=a.x,o.y=a.y,s.left=a.x+"px",s.top=a.y+"px",!0)},stop:function(t){var e,n=this,o=n.dragEvent,i=n.element,r=n.options,s=r.grid;f.off(document,n.handlers.move),i.style.zIndex=o.oldZindex,r.smoothDrag&&s&&(e=n.round({x:o.x,y:o.y},s),n.move(e.x,e.y),f.assign(n.dragEvent,e)),n.dragEvent.started&&r.onDragEnd(i,o.x,o.y,t),n.reset()},reset:function(){this.dragEvent.started=!1},round:function(t){var e=this.options.grid;return{x:e*Math.round(t.x/e),y:e*Math.round(t.y/e)}},getCursor:function(t){return{x:(t.targetTouches?t.targetTouches[0]:t).clientX,y:(t.targetTouches?t.targetTouches[0]:t).clientY}},setCursor:function(t){this._cursor=t},setLimit:function(n){var t=this,e=function(t,e){return{x:t,y:e}};if(n instanceof Function)t.limit=n;else if(h(n)){var o=t._dimensions,i=n.scrollHeight-o.height,r=n.scrollWidth-o.width;t.limit=function(t,e){return{x:f.limit(t,[0,r]),y:f.limit(e,[0,i])}}}else if(n){var s=d(n.x),a=d(n.y);t.limit=s||a?function(t,e){return{x:s?f.limit(t,n.x):t,y:a?f.limit(e,n.y):e}}:e}else t.limit=e},setPosition:function(){var t=this.element,e=t.style;f.assign(this._dimensions,{left:n(e.left)||t.offsetLeft,top:n(e.top)||t.offsetTop})},setZoom:function(){for(var t=this.element,e=1;t=t.offsetParent;){var n=l(t).zoom;if(n&&"normal"!==n){e=n;break}}this._dimensions.zoom=e},useTarget:function(t){var e=this.options.filterTarget;return!(e instanceof Function)||e(t)},destroy:function(){f.off(this.handle,this.handlers.start),f.off(document,this.handlers.move)}}),t});